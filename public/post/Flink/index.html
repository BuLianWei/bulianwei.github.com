<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Flink | Abiu的博客</title>
    <meta property="og:title" content="Flink - Abiu的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-08-19T20:50:34&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-08-19T20:50:34&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Flink">
        
    <meta name="author" content="Abiu">
    <meta property="og:url" content="https://github.com/BuLianWei/bulianwei.github.io.git/post/Flink/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/BuLianWei/bulianwei.github.io.git/css/normalize.css'>
    <link rel="stylesheet" href='/BuLianWei/bulianwei.github.io.git/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-4031353640611810",
        enable_page_level_ads: true
    });
    </script>
    


    
    
        <link rel="stylesheet" href='/BuLianWei/bulianwei.github.io.git/css/douban.css'>
    
        <link rel="stylesheet" href='/BuLianWei/bulianwei.github.io.git/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://github.com/BuLianWei/bulianwei.github.io.git">
                        Abiu的博客
                    </a>
                
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://github.com/BuLianWei/bulianwei.github.io.git">首页</a>
                    
                    <a  href="https://github.com/BuLianWei/bulianwei.github.io.git/notes/" title="笔记">笔记</a>
                    
                    <a  href="https://github.com/BuLianWei/bulianwei.github.io.git/post/" title="归档">归档</a>
                    
                    <a  href="https://github.com/BuLianWei/bulianwei.github.io.git/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Flink</h1>
        </header>
        <date class="post-meta meta-date">
            2020年8月19日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="flink">Flink</h1>
<h2 id="部署">部署</h2>
<ul>
<li>On Yarn
<ul>
<li>
<p>yarn-session
开启session
yarn-session.sh -jm 1024m -tm 4096m
在session上提交作业
flink run -m yarn-cluster -p 4 -yjm 1024m -ytm 4096m ./examples/batch/WordCount.jar
关闭session
echo &ldquo;stop&rdquo; | ./bin/yarn-session.sh -id <!-- raw HTML omitted --></p>
<blockquote>
<p>-D 使用-D将要设置的参数进行设置（-Dtaskmanager.memory.network.min=536346624）
-d,&ndash;detached 		开启分离模式（session启动后client自动关掉）
-jm,&ndash;jobManagerMemory <!-- raw HTML omitted -->    jobmanager 内存大小(默认: MB)
-nm,&ndash;name                      设置应用程序的名称
-at,&ndash;applicationType           设置应用程序的类型
-q,&ndash;query                      查询使用的Yarn的资源（Memory，Core）
-qu,&ndash;queue <!-- raw HTML omitted -->               设置在Yarn上使用的队列.
-s,&ndash;slots <!-- raw HTML omitted -->                设置每个TaskManager的Slot数量
-tm,&ndash;taskManagerMemory <!-- raw HTML omitted -->   设置每个TaskManager的内存大小(默认: MB)
-z,&ndash;zookeeperNamespace <!-- raw HTML omitted --></p>
</blockquote>
</li>
<li>
<p>pro-job
flink run -m yarn-cluster ./examples/batch/WordCount.jar</p>
<blockquote>
<p>run
-c,&ndash;class 		程序全路径名称
-C,&ndash;classpath <!-- raw HTML omitted -->
-n,&ndash;allowNonRestoredState		忽略保存点状态不能被restored的错误
-p,&ndash;parallelism <!-- raw HTML omitted -->	程序并行度(会覆盖进群的配置，集群配置配置 &lt; 程序里配置文件配置 &lt; 运行时指定 ）
-s,&ndash;fromSavepoint <!-- raw HTML omitted -->	设置应用程序保存点文件路径
&mdash;&mdash;&mdash;&mdash;for yarn&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
-d,&ndash;detached
-m,&ndash;jobmanager <!-- raw HTML omitted -->	 设置jobmanger地址
-yat,&ndash;yarnapplicationType <!-- raw HTML omitted -->		设置应用程序的类型
-yD &lt;property=value&gt;						设置配置参数
-yid,&ndash;yarnapplicationId <!-- raw HTML omitted -->			将应用程序提交到yarn-session上运行
-yj,&ndash;yarnjar <!-- raw HTML omitted -->								flink jar 文件地址
-yjm,&ndash;yarnjobManagerMemory <!-- raw HTML omitted -->	设置yarn模式下jobmanager 内存大小（默认：MB）
-ynl,&ndash;yarnnodeLabel <!-- raw HTML omitted -->					设置node标签
-ynm,&ndash;yarnname <!-- raw HTML omitted -->							设置应用程序的名称
-yq,&ndash;yarnquery										查询在yarn上的资源（memory，core）
-yqu,&ndash;yarnqueue <!-- raw HTML omitted -->							设置应用程序队列
-ys,&ndash;yarnslots <!-- raw HTML omitted --> 								设置每个taskmanager的slot数量
-yt,&ndash;yarnship <!-- raw HTML omitted -->
-ytm,&ndash;yarntaskManagerMemory <!-- raw HTML omitted -->		设置每个taskmanager 的内存大小（默认：MB）</p>
</blockquote>
</li>
<li>
<p>application</p>
</li>
</ul>
</li>
</ul>
<h2 id="查看集群作业">查看集群作业</h2>
<ul>
<li>flink list	//列出计划和正在运行的作业</li>
<li>flink list -s	//列出计划的作业</li>
<li>flink list -r	//列出正在执行的作业</li>
<li>flink list -a	//列出所有的作业</li>
</ul>
<h2 id="算子">算子</h2>
<h3 id="map">Map</h3>
<p>数据流一对一的转换，作用在每一条数据上，对流经算子的每一条数据进行相应的操作，输入输出类型可变。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        DataSource<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> elements <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromElements</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;flink&#34;</span><span style="color:#f92672">);</span>
        MapOperator<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> MapFunction<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>String value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;ods-&#34;</span> <span style="color:#f92672">+</span> value<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>

        map<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
ods<span style="color:#f92672">-</span>hello
ods<span style="color:#f92672">-</span>flink
</code></pre></div><h3 id="flatmap">FlatMap</h3>
<p>数据流一对多的转换，作用在每一条数据上，将流经算子的数据拆分成相应的数据进行输出，输入输出数据类型可变。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        DataSource<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> elements <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromElements</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello flink&#34;</span><span style="color:#f92672">);</span>
        FlatMapOperator<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> flatMap <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">flatMap</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FlatMapFunction<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">flatMap</span><span style="color:#f92672">(</span>String value<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>String s <span style="color:#f92672">:</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">split</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
                    out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ods-&#34;</span><span style="color:#f92672">+</span>s<span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>

        flatMap<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
ods<span style="color:#f92672">-</span>hello
ods<span style="color:#f92672">-</span>flink
</code></pre></div><h3 id="mappartition">MapPartition</h3>
<p>数据流多对一的转换，作用在每一个分区上，将分区内的多条数据通过迭代操作然后输出结果，输入输出数据类型可变。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        DataSource<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> elements <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromElements</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;flink&#34;</span><span style="color:#f92672">);</span>
        MapPartitionOperator<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> mapPartition <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> MapPartitionFunction<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Consumer<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span>String s<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ods-&#34;</span> <span style="color:#f92672">+</span> s<span style="color:#f92672">);</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">});</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        mapPartition<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
ods<span style="color:#f92672">-</span>hello
ods<span style="color:#f92672">-</span>flink
</code></pre></div><h3 id="filter">Filter</h3>
<p>数据流一对一的转换，作用在每一条数据上，根据操作函数返回的true和false来确定是否让数据通过进入下一算子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        DataSource<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> elements <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromElements</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;flink&#34;</span><span style="color:#f92672">);</span>
        FilterOperator<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> filter <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FilterFunction<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span>String value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">startsWith</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;h&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        filter<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
hello
</code></pre></div><h3 id="project">Project</h3>
<p>数据流一对一的转换，作用在每一条数据上，将带有元组的数据流根据序号选取，只针对java api调用</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSet<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        DataSet<span style="color:#f92672">&lt;</span>Tuple2<span style="color:#f92672">&lt;</span>Boolean<span style="color:#f92672">,</span>Integer<span style="color:#f92672">&gt;&gt;</span> project <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">project</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>0<span style="color:#f92672">);</span>
        project<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
</code></pre></div><h3 id="reduce">Reduce</h3>
<ul>
<li>不基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
         tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        ReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduce <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value1<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value2<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span> <span style="color:#f92672">+</span> value2<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduce<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>10<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
<li>基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
        ReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduce <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value1<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value2<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>value2<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduce<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
</ul>
<h3 id="groupby">GroupBy</h3>
<ul>
<li>不基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> KeySelector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getKey</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        ReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduce <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value1<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value2<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>value2<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduce<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
<li>基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
        ReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduce <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value1<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value2<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>value2<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value1<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduce<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
</ul>
<h3 id="reducegroup">ReduceGroup</h3>
<p>与reduce的区别在于，reducegroup 可以获取一个组内所有的数据，可以单用也可以和groupby进行组合使用，输入输出类型可变</p>
<ul>
<li>不基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
       tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
       tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        GroupReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduceGroup <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">reduceGroup</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span>
                                                                                                                                    RichGroupReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> tmp <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>0<span style="color:#f92672">};</span>
                <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">};</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Consumer<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> in<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">%</span>2<span style="color:#f92672">==</span>0<span style="color:#f92672">){</span>
                            tmp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">+=</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">;</span>
                            key<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>

                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">});</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>tmp<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> key<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span><span style="color:#66d9ef">false</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduceGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>12<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
<li>基于groupBy
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
        GroupReduceOperator<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> reduceGroup <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">reduceGroup</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span>
                                                                                                                                    RichGroupReduceFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reduce</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> tmp <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>0<span style="color:#f92672">};</span>
                <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">};</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Consumer<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> in<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">%</span>2<span style="color:#f92672">==</span>0<span style="color:#f92672">){</span>
                            tmp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">+=</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">;</span>
                            key<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span>in<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>

                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">});</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>tmp<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> key<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span><span style="color:#66d9ef">false</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        reduceGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>10<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div></li>
</ul>
<h3 id="sortgroup">SortGroup</h3>
<p>组内排序，前提在使用分组聚合以后（groupBy，keyBy）以后，对组内数据进行指定顺序排序操作</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
        SortedGrouping<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> sortGroup <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">sortGroup</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> Order<span style="color:#f92672">.</span><span style="color:#a6e22e">ASCENDING</span><span style="color:#f92672">);</span>
        sortGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">(</span>2<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="groupcombine">GroupCombine</h3>
<p>对数据流进行一次预聚合运算，可以减少数据的传输，该运算通常只有本分数据被聚合不能代替reduce操作，一般都是配合reduce或者reduceGroup进行操作，输入输出类型可变</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        DataSource<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> elements <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromElements</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hello&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;flink&#34;</span><span style="color:#f92672">);</span>
        MapOperator<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;&gt;</span> map <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>word <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">new</span> Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;(</span>word<span style="color:#f92672">,</span> 1<span style="color:#f92672">)).</span><span style="color:#a6e22e">returns</span><span style="color:#f92672">(</span>Types<span style="color:#f92672">.</span><span style="color:#a6e22e">TUPLE</span><span style="color:#f92672">(</span>Types<span style="color:#f92672">.</span><span style="color:#a6e22e">STRING</span><span style="color:#f92672">,</span>
                Types<span style="color:#f92672">.</span><span style="color:#a6e22e">INT</span><span style="color:#f92672">));</span>
        UnsortedGrouping<span style="color:#f92672">&lt;</span>Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;&gt;</span> groupBy <span style="color:#f92672">=</span> map<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
        GroupCombineOperator<span style="color:#f92672">&lt;</span>Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;,</span> Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;&gt;</span> combineGroup <span style="color:#f92672">=</span> groupBy<span style="color:#f92672">.</span><span style="color:#a6e22e">combineGroup</span><span style="color:#f92672">((</span>Iterable<span style="color:#f92672">&lt;</span>Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[</span>1<span style="color:#f92672">];</span>
            <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> cnt <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>0<span style="color:#f92672">};</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
                key<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">;</span>
                cnt<span style="color:#f92672">[</span>0<span style="color:#f92672">]++;</span>
            <span style="color:#f92672">});</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple2<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Integer<span style="color:#f92672">&gt;(</span>key<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> cnt<span style="color:#f92672">[</span>0<span style="color:#f92672">]));</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">returns</span><span style="color:#f92672">(</span>Types<span style="color:#f92672">.</span><span style="color:#a6e22e">TUPLE</span><span style="color:#f92672">(</span>Types<span style="color:#f92672">.</span><span style="color:#a6e22e">STRING</span><span style="color:#f92672">,</span> Types<span style="color:#f92672">.</span><span style="color:#a6e22e">INT</span><span style="color:#f92672">));</span>
        <span style="color:#f92672">;</span>
        combineGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>flink<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>hello<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
</code></pre></div><h3 id="aggregate">Aggregate</h3>
<p>将数据流根据（SUM，MIN，MAX）将某个字段聚合操作，有and运算符时，如果对同一个字段进行操作，只会进行最后操作符（MAX，MIN，SUM）的操作</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataSet<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>SUM<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MAX<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;============&#34;</span><span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>SUM<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">and</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">and</span><span style="color:#f92672">(</span>MAX<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">and</span><span style="color:#f92672">(</span>MAX<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">andMax</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;============&#34;</span><span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MAX<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">and</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;============&#34;</span><span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">aggregate</span><span style="color:#f92672">(</span>MAX<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">and</span><span style="color:#f92672">(</span>MIN<span style="color:#f92672">,</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>21<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">============</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">============</span>
<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//根据第一个字段取最小的，其他字段取最后一条
</span><span style="color:#75715e"></span><span style="color:#f92672">============</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//根据第一个字段取最大的，根据第二个字段取最小的，其他的取最后一条
</span></code></pre></div><h3 id="minby">MinBy</h3>
<p>根据某几个字段求数据里面最小的一条，相当于order by col1,col2 asc</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataSet<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">minBy</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">minBy</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//只根据第一个字段取最小的那条记录
</span><span style="color:#75715e"></span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//根据第一个字段和第二个字段取最小的那条记录
</span></code></pre></div><h3 id="maxby">MaxBy</h3>
<p>根据某几个字段求数据里面最大的一条，相当于order by col1,col2 desc</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>6<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataSet<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">maxBy</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">maxBy</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//只根据第一个字段取最大的那条记录
</span><span style="color:#75715e"></span><span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>	<span style="color:#75715e">//根据第一个和第二个字段取最大的那条记录
</span><span style="color:#75715e"></span>
</code></pre></div><h3 id="distinct">Distinct</h3>
<p>distinct 可以根据字段序号，keyselect或者对象的属性名字直接进行去重</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">distinct</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="join">Join</h3>
<ul>
<li>
<p>join</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    source<span style="color:#f92672">.</span><span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>source<span style="color:#f92672">).</span><span style="color:#a6e22e">where</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">equalTo</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">((</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">),(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">),(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
<span style="color:#f92672">((</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">),(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">))</span>
</code></pre></div><pre><code>   
 input1.join(input2, JoinHint.BROADCAST_HASH_FIRST)
 - JoinHint.OPTIMIZER_CHOOSES
     任系统自己选择
 - JoinHint.BROADCAST_HASH_FIRST
     对第一个表进行hash，广播第一个表，小表join大表
 - JoinHint.BROADCAST_HASH_SECOND
     对第二个表进行hash，广播第二个表，大表join小表
 - JoinHint.REPARTITION_HASH_FIRST
     对每个表都进行分区，并且对第一个表进行hash，小表join大表，但是两个表任然很大
     如果无法进行大小估计并且无法重新使用现有的分区和排序顺序，这是系统使用的默认后备策略
 - JoinHint.REPARTITION_HASH_SECOND
     对每个表都进行分区，并且对第二个表进行hash，大表join小表，但是两个表任然很大
 - JoinHint.REPARTITION_SORT_MERGE
     对每个表都进行分区，对每个表都进行排序，对有排序的表性能会提高

</code></pre></li>
<li>
<p>joinWithTiny
JoinHint.BROADCAST_HASH_FIRST</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
</code></pre></div><pre><code></code></pre></li>
<li>
<p>joinWithHuge
JoinHint.BROADCAST_HASH_SECOND</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
</code></pre></div><pre><code>

</code></pre></li>
</ul>
<h3 id="outerjoin">OuterJoin</h3>
<ul>
<li>
<p>LeftOuterJoin</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
  
    JoinFunctionAssigner<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> equalTo <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">leftOuterJoin</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">where</span><span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">equalTo</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> JoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> second <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
  
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;===============&#34;</span><span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FlatJoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>second <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">));</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">===============</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code> - OPTIMIZER_CHOOSES
 - BROADCAST_HASH_SECOND
 - REPARTITION_HASH_SECOND
 - REPARTITION_SORT_MERGE

</code></pre></li>
<li>
<p>RightOuterJoin</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
  
    JoinFunctionAssigner<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> equalTo <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">rightOuterJoin</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">where</span><span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">equalTo</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> JoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> second <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
  
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;===============&#34;</span><span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FlatJoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>second <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">));</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">===============</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code> - OPTIMIZER_CHOOSES
 - BROADCAST_HASH_FIRST
 - REPARTITION_HASH_FIRST
 - REPARTITION_SORT_MERGE

</code></pre></li>
<li>
<p>FullOuterJoin</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
  
    JoinFunctionAssigner<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> equalTo <span style="color:#f92672">=</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">fullOuterJoin</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">where</span><span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">equalTo</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> JoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> first <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> second<span style="color:#f92672">:</span>second<span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
  
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;===============&#34;</span><span style="color:#f92672">);</span>
    equalTo<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FlatJoinFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">join</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> second<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>first <span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> second<span style="color:#f92672">:</span>second<span style="color:#f92672">==</span><span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> first<span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>second<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>first<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">));</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">===============</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code> - OPTIMIZER_CHOOSES
 - REPARTITION_SORT_MERGE

</code></pre></li>
</ul>
<h3 id="cross">Cross</h3>
<p>笛卡尔积</p>
<ul>
<li>
<p>cross</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
    tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
  
    source<span style="color:#f92672">.</span><span style="color:#a6e22e">cross</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> CrossFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">cross</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> val1<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> val2<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;&gt;(</span>val1<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span>val2<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>val1<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>val2<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>val1<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>a<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>6<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>7<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>8<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>9<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">-</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code></code></pre></li>
<li>
<p>crossWithTiny</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
</code></pre></div><pre><code></code></pre></li>
<li>
<p>crossWithHuge</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
</code></pre></div><pre><code></code></pre></li>
</ul>
<h3 id="cogroup">CoGroup</h3>
<p>coGroup 会将两个流的所有相等不相等的数据都可以输出，可以看做是针对所有key的group，两个流的类型可以不一样</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>


        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">coGroup</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">where</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">equalTo</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">with</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> CoGroupFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">coGroup</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> first<span style="color:#f92672">,</span> Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> second<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>

               first<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
               second<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="union">Union</h3>
<p>两个或者多个流必须一样</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>


        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">union</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="rebalance">Rebalance</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>


        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                    <span style="color:#66d9ef">throws</span>
                    Exception <span style="color:#f92672">{</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
                    out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
                <span style="color:#f92672">});</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">rebalance</span><span style="color:#f92672">().</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                    String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                    <span style="color:#66d9ef">throws</span>
                    Exception <span style="color:#f92672">{</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
                    out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()</span>
                            <span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
                <span style="color:#f92672">});</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
</code></pre></div><h3 id="partitionby">PartitionBy</h3>
<ul>
<li>
<p>partitionByHash</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>


    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
  
    source<span style="color:#f92672">.</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                <span style="color:#66d9ef">throws</span>
                Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
              out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">});</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">partitionByHash</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>
            String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                <span style="color:#66d9ef">throws</span>
                Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()</span>
                        <span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">});</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
</code></pre></div></li>
<li>
<p>partitionByRange</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>


    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
  
    source<span style="color:#f92672">.</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                <span style="color:#66d9ef">throws</span>
                Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
              out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">});</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">partitionByRange</span><span style="color:#f92672">(</span>0<span style="color:#f92672">).</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>
            String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                <span style="color:#66d9ef">throws</span>
                Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>x<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()</span>
                        <span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">});</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
</code></pre></div></li>
<li>
<p>sortPartition</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
    ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
    Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

    DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

    source<span style="color:#f92672">.</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>x<span style="color:#f92672">);</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>x<span style="color:#f92672">);</span>
            <span style="color:#f92672">});</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;==============&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">sortPartition</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>Order<span style="color:#f92672">.</span><span style="color:#a6e22e">ASCENDING</span><span style="color:#f92672">).</span><span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapPartitionFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mapPartition</span><span style="color:#f92672">(</span>Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
            values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>x<span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>x<span style="color:#f92672">);</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>x<span style="color:#f92672">);</span>
            <span style="color:#f92672">});</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}).</span><span style="color:#a6e22e">count</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">==============</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code></code></pre></li>
</ul>
<h3 id="first">First</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        ExecutionEnvironment env <span style="color:#f92672">=</span> ExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">(</span>2<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=====================&#34;</span><span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">groupBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">first</span><span style="color:#f92672">(</span>2<span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">=====================</span>
<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
<span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><p>+++</p>
<h3 id="keyby">KeyBy</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">keyBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">process</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> KeyedProcessFunction<span style="color:#f92672">&lt;</span>Tuple<span style="color:#f92672">,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                String<span style="color:#f92672">&gt;&gt;</span>
                <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processElement</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">,</span> Context ctx<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                    String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                    <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">));</span>

            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>

        env<span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>6<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>7<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
</code></pre></div><blockquote>
<p><code>2&gt;</code> 2表示执行该任务的线程号，就是getRuntimeContext().getIndexOfThisSubtask()+1</p>
</blockquote>
<h3 id="fold">Fold</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">keyBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">fold</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;start&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> FoldFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;,</span> String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">fold</span><span style="color:#f92672">(</span>String accumulator<span style="color:#f92672">,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> accumulator<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">+</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">+</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> start<span style="color:#f92672">-</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span>
6<span style="color:#f92672">&gt;</span> start<span style="color:#f92672">-</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span>
2<span style="color:#f92672">&gt;</span> start<span style="color:#f92672">-</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">-</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span>
6<span style="color:#f92672">&gt;</span> start<span style="color:#f92672">-</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">-</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span>
2<span style="color:#f92672">&gt;</span> start<span style="color:#f92672">-</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">-</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">-</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span>
</code></pre></div><blockquote>
<p>fold is deprecated</p>
</blockquote>
<h3 id="window">Window</h3>
<ul>
<li>
<p>window</p>
<p>需要对数据流先进行keyBy操作，将数据流按照每个key进行分区，再在每个key分区上进行window操作，每个key分区一个window会有很多window。</p>
<ul>
<li>
<p>timeWindow</p>
<ul>
<li>timeWindow(size)<br>
window(TumblingProcessingTimeWindows.of(size)) or window(TumblingEventTimeWindows.of(size))</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">      StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>
    
      ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
      Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    
      tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
      list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
      tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
      list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
      tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
      list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
      tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
    
DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
    
      source<span style="color:#f92672">.</span><span style="color:#a6e22e">assignTimestampsAndWatermarks</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AscendingTimestampExtractor<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
          <span style="color:#a6e22e">@Override</span>
          <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">extractAscendingTimestamp</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> element<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
              <span style="color:#66d9ef">return</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">();</span>
          <span style="color:#f92672">}</span>
<span style="color:#f92672">}).</span><span style="color:#a6e22e">keyBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">timeWindow</span><span style="color:#f92672">(</span>Time<span style="color:#f92672">.</span><span style="color:#a6e22e">milliseconds</span><span style="color:#f92672">(</span>1<span style="color:#f92672">))</span>
<span style="color:#75715e">//                .window(TumblingEventTimeWindows.of(Time.milliseconds(1)))
</span><span style="color:#75715e"></span>      <span style="color:#f92672">.</span><span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> WindowFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple<span style="color:#f92672">,</span> TimeWindow<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
          <span style="color:#a6e22e">@Override</span>
          <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span>Tuple tuple<span style="color:#f92672">,</span> TimeWindow window<span style="color:#f92672">,</span> Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> input<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                input<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
    <span style="color:#960050;background-color:#1e0010">```</span>

<span style="color:#f92672">-</span> timeWindow<span style="color:#f92672">(</span>size<span style="color:#f92672">,</span>slide<span style="color:#f92672">)</span>
    window<span style="color:#f92672">(</span>SlidingProcessingTimeWindows<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>size<span style="color:#f92672">,</span> slide<span style="color:#f92672">))</span> or <span style="color:#a6e22e">window</span><span style="color:#f92672">(</span>SlidingEventTimeWindows<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>size<span style="color:#f92672">,</span> slide<span style="color:#f92672">))</span>
          
    <span style="color:#960050;background-color:#1e0010">```</span>java
            StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>
            ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
            Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
            list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
          
            tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
            list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
            tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
            list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
            tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
            list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
            tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
            list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
          
            DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
          
            source<span style="color:#f92672">.</span><span style="color:#a6e22e">assignTimestampsAndWatermarks</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AscendingTimestampExtractor<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
                <span style="color:#a6e22e">@Override</span>
                <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">extractAscendingTimestamp</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> element<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">return</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">();</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}).</span><span style="color:#a6e22e">keyBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">timeWindow</span><span style="color:#f92672">(</span>Time<span style="color:#f92672">.</span><span style="color:#a6e22e">milliseconds</span><span style="color:#f92672">(</span>1<span style="color:#f92672">),</span>Time<span style="color:#f92672">.</span><span style="color:#a6e22e">milliseconds</span><span style="color:#f92672">(</span>1<span style="color:#f92672">))</span>
    <span style="color:#75715e">//                .window(SlidingEventTimeWindows.of(Time.milliseconds(1), Time.milliseconds(1)))
</span><span style="color:#75715e"></span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> WindowFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple<span style="color:#f92672">,</span> TimeWindow<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                <span style="color:#a6e22e">@Override</span>
                <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span>Tuple tuple<span style="color:#f92672">,</span> TimeWindow window<span style="color:#f92672">,</span> Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> input<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                    input<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------</span>
    结果<span style="color:#960050;background-color:#1e0010">：</span>
    2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
    6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
    2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
    2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
    6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
    <span style="color:#960050;background-color:#1e0010">```</span>
</code></pre></div></li>
<li>
<p>countWindow</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>
      
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
      
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
      
        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
      
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">assignTimestampsAndWatermarks</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AscendingTimestampExtractor<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">extractAscendingTimestamp</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> element<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">keyBy</span><span style="color:#f92672">(</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">countWindow</span><span style="color:#f92672">(</span>2<span style="color:#f92672">).</span><span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> WindowFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple<span style="color:#f92672">,</span> GlobalWindow<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span>Tuple tuple<span style="color:#f92672">,</span> GlobalWindow window<span style="color:#f92672">,</span> Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> input<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                input<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code>   
</code></pre></li>
</ul>
</li>
<li>
<p>windowAll</p>
<p>不用进行分区直接对数据流进行window操作，所有key都在这一个window上进行操作，只有一个window</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>
  
        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
  
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
  
        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
  
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">windowAll</span><span style="color:#f92672">(</span>GlobalWindows<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">()).</span><span style="color:#a6e22e">trigger</span><span style="color:#f92672">(</span>PurgingTrigger<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>CountTrigger<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>3<span style="color:#f92672">))).</span><span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AllWindowFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> GlobalWindow<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span>GlobalWindow window<span style="color:#f92672">,</span> Iterable<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> values<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                values<span style="color:#f92672">.</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>out<span style="color:#f92672">::</span>collect<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">-----------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</code></pre></div><pre><code>
</code></pre></li>
</ul>
<h3 id="connect">Connect</h3>
<p>将两个具有相同或者不同结构的流，融合成一个流。两个流的元素类型可以不同。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
        
        source<span style="color:#f92672">.</span><span style="color:#a6e22e">connect</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">process</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> CoProcessFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>
                String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processElement1</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">,</span> Context ctx<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span>
                    <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">}</span>

            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">processElement2</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">,</span> Context ctx<span style="color:#f92672">,</span> Collector<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;</span> out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                out<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">));</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
</code></pre></div><h3 id="comap">CoMap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>2<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>
        tuple4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b1&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple4<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>
        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source1 <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">connect</span><span style="color:#f92672">(</span>source1<span style="color:#f92672">).</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> CoMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>
                Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map1</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>

            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map2</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>2<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b1<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a1<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
</code></pre></div><h3 id="coflatmap">CoFlatMap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
</code></pre></div><h3 id="split">Split</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">split</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> OutputSelector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Iterable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">select</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">%</span>2<span style="color:#f92672">==</span>0<span style="color:#f92672">){</span>
                    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">return</span> list<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">select</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="select">Select</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">split</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> OutputSelector<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Iterable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">select</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">%</span>2<span style="color:#f92672">==</span>0<span style="color:#f92672">){</span>
                    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;2&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">return</span> list<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">select</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="partitioncustom">PartitionCustom</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">partitionCustom</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Partitioner<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">partition</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> numPartitions<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> key<span style="color:#f92672">.</span><span style="color:#a6e22e">hashCode</span><span style="color:#f92672">()%</span>numPartitions<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">},</span>1<span style="color:#f92672">).</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>6<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>7<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
</code></pre></div><h3 id="shuffle">Shuffle</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">shuffle</span><span style="color:#f92672">().</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span>  Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>6<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>7<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
</code></pre></div><h3 id="rebalance-1">Rebalance</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">rebalance</span><span style="color:#f92672">().</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span>  Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>6<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>7<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
</code></pre></div><h3 id="rescale">Rescale</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">rescale</span><span style="color:#f92672">().</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span>  Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>7<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
</code></pre></div><h3 id="broadcast">Broadcast</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        StreamExecutionEnvironment env <span style="color:#f92672">=</span> StreamExecutionEnvironment<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutionEnvironment</span><span style="color:#f92672">();</span>
        env<span style="color:#f92672">.</span><span style="color:#a6e22e">setStreamTimeCharacteristic</span><span style="color:#f92672">(</span>TimeCharacteristic<span style="color:#f92672">.</span><span style="color:#a6e22e">EventTime</span><span style="color:#f92672">);</span>

        ArrayList<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
        Tuple3 tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>5<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>
        tuple3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tuple3<span style="color:#f92672">);</span>

        DataStreamSource<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;&gt;</span> source <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span><span style="color:#a6e22e">fromCollection</span><span style="color:#f92672">(</span>list<span style="color:#f92672">);</span>

        source<span style="color:#f92672">.</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">&gt;,</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple3<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple4<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">broadcast</span><span style="color:#f92672">().</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> RichMapFunction<span style="color:#f92672">&lt;</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;,</span> Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span>  Tuple5<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>Boolean<span style="color:#f92672">,</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Tuple4<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">,</span> Boolean<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> value<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Tuple5<span style="color:#f92672">&lt;&gt;(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">f0</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f1</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f2</span><span style="color:#f92672">,</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">f3</span><span style="color:#f92672">,</span>getRuntimeContext<span style="color:#f92672">().</span><span style="color:#a6e22e">getIndexOfThisSubtask</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#a6e22e">print</span><span style="color:#f92672">();</span>
<span style="color:#f92672">---------------------------------------------------------------------------------------------------------------------------------</span>
结果<span style="color:#960050;background-color:#1e0010">：</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
5<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>4<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>2<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
4<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>3<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>1<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
8<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>7<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span>1<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>5<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>4<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>3<span style="color:#f92672">,</span>a<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>2<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
6<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>5<span style="color:#f92672">)</span>
1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>0<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>5<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
7<span style="color:#f92672">&gt;</span> <span style="color:#f92672">(</span>4<span style="color:#f92672">,</span>b<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>3<span style="color:#f92672">,</span>6<span style="color:#f92672">)</span>
</code></pre></div><h2 id="分区策略">分区策略</h2>
<h3 id="globalpartitioner">GlobalPartitioner</h3>
<h3 id="shufflepartitioner">ShufflePartitioner</h3>
<h3 id="rebalancepartitioner">RebalancePartitioner</h3>
<h3 id="rescalepartitioner">RescalePartitioner</h3>
<h3 id="broadcastpartitioner">BroadcastPartitioner</h3>
<h3 id="forwardpartitioner">ForwardPartitioner</h3>
<h3 id="keygroupstreampartitioner">KeyGroupStreamPartitioner</h3>
<h3 id="custompartitionerwrapper">CustomPartitionerWrapper</h3>
<h2 id="数据转换策略">数据转换策略</h2>
<h3 id="forward转发">forward（转发）</h3>
<p>数据从一个算子一对一的转换到下游另一个算子，同机器无网络传送</p>
<h3 id="broadcast广播">broadcast（广播）</h3>
<p>数据复制一份从上一个算子发送到下游每一个算子</p>
<h3 id="key-based基于键值">key-based（基于键值）</h3>
<p>根据key将数据按照key发送到下游算子</p>
<h3 id="random随机">random（随机）</h3>
<p>数据均匀分配至下游算子</p>
<h2 id="组件">组件</h2>
<h3 id="jobmanager">JobManager</h3>
<h3 id="resourcemanager">ResourceManager</h3>
<h3 id="taskmanager">TaskManager</h3>
<h3 id="dispatcher">Dispatcher</h3>
<p>+++</p>
<h2 id="application">Application</h2>
<ul>
<li>启动：flink run -c mainclasspath jarpath</li>
<li>取消：flink cancel jobid</li>
<li>停止：flink stop jobid</li>
</ul>
<h3 id="job">Job</h3>
<h2 id="task">Task</h2>
<p>job中的一个阶段就是一个task，一个task包括链条连接的多个subtask，一个task运行在一个线程里面，task平分slot里面的内存资源共享slot里面的cpu资源</p>
<h2 id="subtask">SubTask</h2>
<p>flink job中最小执行单元</p>
<h2 id="算子-1">算子</h2>
<h3 id="source">Source</h3>
<p>使用EventTime，划分滚动窗口，如果使用的是并行的Source，例如KafkaSource，创建Kafka的Topic时有多个分区，每个Source的分区都要满足触发的条件，整个窗口才会被触发</p>
<h3 id="transformation">Transformation</h3>
<ul>
<li>map	//DataStream - &gt; DataStream</li>
<li>flatMap	//DataStream -&gt; DataStream</li>
<li>filter	//DataStream -&gt; DataStream</li>
<li>keyBy	//DataStream -&gt; KeyStream</li>
</ul>
<h3 id="sink">Sink</h3>
<p>writeAsCsv必须是元组才能正常写入</p>
<h2 id="watermark">WaterMark</h2>
<p>决定一个窗口什么时候激活（触发），这时的窗口的最大长度为</p>
<p>materMark&gt;=上一个窗口的结束边界就会触发窗口执行</p>
<p>watermark是flink中窗口延迟触发的机制</p>
<p>在每个算子内部都自己有一个事件时间时钟，事件时间时钟是根据watermark来更新的，。流入算子的数据可能是单分区也可能是多分区的，每个流入算子的分区端都会有一个自己的partition watermark标记，当该分区内进入新的高于之前watermark的watermark数据时，partition watermark标记才会被更新，task内部也维护一个task的watermark数据。如果某个分区的partition watermark &lt; task watermark，那么task watermark会更新为该partition watermark数据，然后把task 把当前更新的task watermark数据发向下游task。</p>
<h3 id="assignerwithperiodicwatermarks">AssignerWithPeriodicWatermarks</h3>
<p>windowmax=watermark+windowsize
waterMark=数据携带的时间（窗口中最大的时间）-延迟执行的时间</p>
<p>周期性的生成watermark，定期向分区数据流中插入时间水印。默认周期时间为200毫秒，可以使用setAutoWatermakrIntaval（）来设置
BoundedOutOfOrdernessTimestampExtractor继承自AssignerWithPeriodicWatermarks 属于周期性watermark</p>
<blockquote>
<p>周期性数据水印在特定条件下可能会造成数据错误
例如：env.fromCollection(List((1, &ldquo;a1&rdquo;, 158324361000l), (1, &ldquo;a2&rdquo;, 158324369000l), (1, &ldquo;a3&rdquo;, 158324364000l), (1, &ldquo;a4&rdquo;, 158324361000l), (1, &ldquo;a5&rdquo;,158324365000l), (1, &ldquo;a6&rdquo;, 158324362000l), (1, &ldquo;a7&rdquo;,158324367000l)))
.assignTimestampsAndWatermarks(new BoundedOutOfOrdernessTimestampExtractor<a href="Time.milliseconds(0)">(Int, String, Long)</a> {
override def extractTimestamp(element: (Int, String, Long)): Long = {
element._3
}
})
.keyBy(0)
.window(TumblingEventTimeWindows.of(Time.seconds(4)))
.sum(2)
.print()
当使用周期性水印AssignerWithPeriodicWatermarks时就会造成数据的错误计算
是因为周期性水印是定期产生的（默认200毫秒）但是在这个周期里可能会出现有多个数据已经过去，这多个数据用于一个水印从而造成数据计算错误</p>
</blockquote>
<h3 id="assignerwithpunctuatedwatermarks">AssignerWithPunctuatedWatermarks</h3>
<p>根据事件生成watermark。可以用于根据具体数据来生成watermark，</p>
<h2 id="window-1">Window</h2>
<h3 id="keyed-window">Keyed Window</h3>
<p>使用keyby后流的窗口</p>
<h4 id="globalwindow">GlobalWindow</h4>
<h4 id="countwindow">CountWindow</h4>
<h4 id="timewindow">TimeWindow</h4>
<ul>
<li>Tumbling</li>
<li>Sliding</li>
<li>Session</li>
</ul>
<h3 id="non-keyed-windows">Non-Keyed Windows</h3>
<p>未使用keyby后流的窗口</p>
<h4 id="windowall">windowAll</h4>
<h2 id="window-之后的算子">Window 之后的算子</h2>
<h3 id="trigger">Trigger</h3>
<p>window 数据触发器，keyed or non-keyed window 都可以使用</p>
<ul>
<li>EventTimeTrigger：事件时间触发器</li>
<li>ProcessingTimeTrigger：程序时间触发器</li>
<li>CountTrigger：数量出发器。只发送窗口触发信号</li>
<li>PurgingTrigger：代理模式触发器，发送窗口触发和数据清理信号</li>
</ul>
<h3 id="evictor">Evictor</h3>
<p>window 数据剔除器，可以在window执行前或者执行后剔除window内的元素</p>
<ul>
<li>CountEvictor：数量剔除器。在Window中保留指定数量的元素，并从窗口头部开始丢弃其余元素。</li>
<li>DeltaEvictor： 阈值剔除器。计算Window中最后一个元素与其余每个元素之间的增量，丢弃增量大于或等于阈值的元素。</li>
<li>TimeEvictor：时间剔除器。保留Window中最近一段时间内的元素，并丢弃其余元素。</li>
</ul>
<h3 id="allowedlateness">AllowedLateness</h3>
<p>决定一个窗口什么时候销毁，window 延迟数据是否保留计算，可能会造成窗口的二次触发，会导致结果数据的更新，造成数据不一致。这时窗口的最大长度为windowmax=waterma+windowsize+allowedleteness</p>
<h2 id="state">State</h2>
<h3 id="managed-state">Managed State</h3>
<h4 id="operator-state">Operator State</h4>
<p>operator state 绑定到每个算子的实例上，各个实例拥有自己的state，一个实例无法获取同并行的其他实例的state数据</p>
<p>operator state ：记录的是每一个分区的偏移量</p>
<h4 id="keyed-state">Keyed State</h4>
<p>keyedstate：在一个subtask中可能有多个state，一个组对应一个key的状态</p>
<h3 id="raw-state">Raw State</h3>
<h2 id="checkpoint">CheckPoint</h2>
<p>全自动程序管理，轻量快捷算子级数据快照</p>
<p>开启flink checkpoint 后设置精准一次消费，kafka的offset会保存在savepoint设置的路径里面，还会降offset保存在kafka 特殊topic里面，如果程序重启时没有指定savepiont保存数据的地址会默认根据kafka 特殊topic保存的偏移量消费数据，可以设置不降offset保存在kafka 特殊topic里面使用，setCommitOffsetOnCheckpoints(false)</p>
<p>开启检查点机制</p>
<pre><code>// start a checkpoint every 1000 ms
env.enableCheckpointing(1000);

// advanced options:

// set mode to exactly-once (this is the default)
env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);

// make sure 500 ms of progress happen between checkpoints
env.getCheckpointConfig().setMinPauseBetweenCheckpoints(500);

// checkpoints have to complete within one minute, or are discarded
env.getCheckpointConfig().setCheckpointTimeout(60000);

// allow only one checkpoint to be in progress at the same time
env.getCheckpointConfig().setMaxConcurrentCheckpoints(1);

// enable externalized checkpoints which are retained after job cancellation
env.getCheckpointConfig().enableExternalizedCheckpoints(ExternalizedCheckpointCleanup.RETAIN_ON_CANCELLATION);

// allow job recovery fallback to checkpoint when there is a more recent savepoint
env.getCheckpointConfig().setPreferCheckpointForRecovery(true);
</code></pre><h3 id="barrier">Barrier</h3>
<p>算子checkpoint的依据，是exactly-once 和at-least-once语义的根据</p>
<h2 id="savepoint">SavePoint</h2>
<p>人工参与管理的application级别的数据快照</p>
<h3 id="手动保存数据快照">手动保存数据快照</h3>
<ul>
<li>
<p>flink stop jobid
停止job并保存快照，如果在flink-conf.yaml上配置了state.savepoints.dir，停止任务后会自动将快照保存。</p>
</li>
<li>
<p>flink stop jobid -p dirpath
停止job并将快照保存在dirpath</p>
</li>
<li>
<p>flink savepoint jobid [dirpath]
在不结束job的情况下保存快照。如果带有dirpath则会将快照保存在此目录否则会保存在默认配置的保存目录</p>
</li>
</ul>
<h3 id="从数据快照恢复程序">从数据快照恢复程序</h3>
<ul>
<li>
<p>直接从savepoint目录恢复
flink run -s dirpath
从dirpath目录恢复程序</p>
</li>
<li>
<p>跳过无法恢复的算子恢复
flink run -s dirpath -n</p>
</li>
</ul>
<h3 id="手动清除数据快照">手动清除数据快照</h3>
<ul>
<li>flink savepoint -d itemdirpath
手动将数据某个具体快照删除（itemdirpath 快照具体根目录）</li>
</ul>
<h2 id="cepcomplex-event-processing">CEP（Complex Event Processing）</h2>
<p>NFA（Nondeterministic Finite Automaton）</p>
<h2 id="反压">反压</h2>
<p>flink 三层buff缓存（resultsubpartition，nettybuff，netty中通过高水位来控制buff是否还可以接收数据，socketbuff）</p>
<p>1.5 之前是基于tcp 窗口的反压机制，发送端根据接收端返回的ack和windox size 来发送数据，当window size 为0时，发送端则不会再附上数据，而是发送一个zerowindow 的探测性数据来确定是否可以再次发送数据，当接收端继续可以接收数据时，发送端才会继续发送数据</p>
<p>基于tcp窗口的反压机制缺点
1.单个task造成的反压，会阻断整个TM-TM的socket，连chekcpoint barrier 也无法发送
2.反压路径较长，导致生效延迟较大</p>
<p>1.5 引入credit 机制实现反压，credit 反压机制是类似于tcp 窗口反压实现的另一种反压机制，resultsubpartition在发送数据时会带有resultbuff里面还存有的数据大小 backlog size，inputchanel在接收到时会计算自己当前还能接收到的数据大小，当inputchanel无法再接收数据时会将credit置为0，告诉result不能再接收消息。result每次发送消息时会检测当前自己的credit数据，当credit为0时 则不会再向netty发送数据从而实现反压机制</p>
<h2 id="flink-保持数据一直性exactly-once">Flink 保持数据一直性（Exactly-Once）</h2>
<ul>
<li>
<p>内部保证 —— checkpoint</p>
</li>
<li>
<p>source 端 —— 可重设数据的读取位置</p>
</li>
<li>
<p>sink 端 —— 从故障恢复时，数据不会重复写入外部系统</p>
<ul>
<li>
<p>幂等写入</p>
<p>所谓幂等操作，是说一个操作，可以重复执行很多次，但只导致一次结果更改，也就是说，后面再重复执行就不起作用了</p>
<p>从Flink程序sink到的key-value存储中读取数据的应用，在Flink从检查点恢复的过程中，可能会看到不想看到的结果。当重播开始时，之前已经发出的计算结果可能会被更早的结果所覆盖（因为在恢复过程中）。所以，一个消费Flink程序输出数据的应用，可能会观察到时间回退，例如读到了比之前小的计数。</p>
</li>
<li>
<p>事务写入</p>
<p>应用程序中一系列严密的操作，所有操作必须成功完成，否则在每个操作中所作的所有更改都会被撤消。具有原子性：一个事务中的一系列的操作要么全部成功，要么一个都不做。</p>
<p>事务性的方法将不会遭受幂等性写入所遭受的重播不一致的问题。但是，事务性写入却带来了延迟，因为只有在检查点完成以后，我们才能看到计算结果。</p>
<p>Flink提供了两种构建模块来实现事务性sink连接器：write-ahead-log（<strong>WAL</strong>，预写式日志）sink和<strong>两阶段提交sink</strong>。</p>
<ul>
<li>
<p>预写日志（Write-Ahead-Log , WAL）</p>
<p>（1）把结果数据先当成状态保存，然后在收到chekpoint完成的通知时，一次性写入sink系统
（2）简单易于实现，由于数据提前在状态后端中做了缓存，所以无论什么sink系统，都能用这种方式一批搞定
（3）DataStream API 提供了一个模板类：GenericWriteAheadSink，来实现这种事务性sink</p>
</li>
<li>
<p>两阶段提交（Two-Phase-Commit , 2PC）</p>
</li>
</ul>
<p>（1）对于每个checkpoint，sink任务会启动一个事务，并将接下来所有接受的数据添加到事务里
（2）然后将这些数据写入外部sink系统，但不提交他们——这是只是“预提交”
（3）当它收到checkpoint完成的通知时，它才正式提交事务，实现结果的真正写入
（4）这种方式真正实现了exactly-once，它需要一个提供事务支持的外部sink系统。Flink提供了TwoPhaseCommitSinkFunction接口。</p>
</li>
</ul>
<blockquote>
<p>在使用kafka011 sink 时注意的点：</p>
<p>1.为了保证事务特性，在使用其他程序去消费我们flink sink 数据的kafka时，这个consumer需要设置了<code>isolation.level = read_committed</code>，那么它只会读取已经提交了的消息。</p>
<p>2.Checkpoint超时时间 必需大于 kafka 提交事务时间。</p>
<p>假如checkpoint失败时间高于 kafka事务等待时间，比如，设置了一个checkpoint最多等待10分钟，10分钟后会失败这个checkpoint的保存。而kafka 的事务只能等待5分钟，5分钟后把uncommitted的事务关掉。这个时候6分钟checkpoint成功了，但是对应kafka数据的事务已经失败。这样就无法保证Exactly-once的实现</p>
</blockquote>
</li>
</ul>
<h2 id="其他">其他</h2>
<p>两个流join 必须有等值字段必须都在同一个窗口里面</p>
<p>duplicate key update  mysql数据库的更新插入 合为一条sql</p>
<p>并行度： <strong>算子级别</strong> &gt; <strong>env级别</strong> &gt; <strong>Client级别</strong> &gt; <strong>系统默认级别</strong></p>
<p>在所有Task共享资源槽点名字相同，默认情况下 （pipline）
同一个job的同一个Task中的多个subTask不能在同一个slot槽中</p>
<blockquote>
<p>具有并行度的subtask 不能在一个slot槽中
对于同一个job，不同Task【阶段】的subTask可以在同一个资源槽中</p>
</blockquote>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://github.com/BuLianWei/bulianwei.github.io.git">Abiu</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Flink/">https://github.com/BuLianWei/bulianwei.github.io.git/post/Flink/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/BuLianWei/bulianwei.github.io.git/post/Hadoop/">Hadoop</a></li>
        
        <li><a href="/BuLianWei/bulianwei.github.io.git/post/Hive/">Hive</a></li>
        
        <li><a href="/BuLianWei/bulianwei.github.io.git/notes/Kafka/">Kafka</a></li>
        
        <li><a href="/BuLianWei/bulianwei.github.io.git/notes/Redis/">Redis</a></li>
        
        <li><a href="/BuLianWei/bulianwei.github.io.git/about/">个人简历</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            没有标签
            
        </div>
    </article>
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "your github repo"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://github.com/BuLianWei/bulianwei.github.io.git/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://github.com/BuLianWei/bulianwei.github.io.git">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Kubernetes%E5%AE%89%E8%A3%85/" title="Kubernetes安装">Kubernetes安装</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Docekr%E5%AE%89%E8%A3%85/" title="Docekr安装">Docekr安装</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Trouble/" title="Trouble">Trouble</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/%E6%95%B0%E4%BB%93/" title="数仓">数仓</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/HBase/" title="HBase">HBase</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Flume/" title="Flume">Flume</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Kafka/" title="Kafka">Kafka</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Spark/" title="Spark">Spark</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Flink/" title="Flink">Flink</a>
    </li>
    
    <li>
        <a href="https://github.com/BuLianWei/bulianwei.github.io.git/post/Hadoop/" title="Hadoop">Hadoop</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">福利派送</h3>
    <ul class="widget-list">
        
        <li>
            <a href="" title="这里是广告位" target="_blank" style="color:red">
                
                    这里是广告位
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="" title=""></a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://github.com/BuLianWei/bulianwei.github.io.git/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="container">
        &copy; 2020 <a href="https://github.com/BuLianWei/bulianwei.github.io.git">Abiu的博客 By Abiu</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/flysnow-org/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>


<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/BuLianWei/bulianwei.github.io.git/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/BuLianWei/bulianwei.github.io.git/js/douban.js'></script>

</body>

</html>